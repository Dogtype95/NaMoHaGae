<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.kro.namohagae.mall.dao.ProductDao">
    <!--상품 정보 저장-->
    <insert id="save">
        <selectKey keyProperty="productNo" order="BEFORE" resultType="int">
            select product_seq_product_no.nextval from dual
        </selectKey>
        insert into PRODUCT(product_no,product_category_no,product_name,product_price,product_stock,product_grade,product_content,product_write_date)
        values(#{productNo},#{productCategoryNo},#{productName},#{productPrice},#{productStock},#{productGrade},#{productContent},#{productWriteDate})
    </insert>

    <!--특정 카테고리의 상품 개수를 조회-->
    <select id="count" resultType="java.lang.Integer" parameterType="String">
        select count(*) from PRODUCT p
        join PRODUCT_CATEGORY c on p.product_category_no = c.product_category_no
        where c.product_category_name = #{categoryName}
    </select>

    <!-- 상품 목록 조회 -->
    <!--
    <select id="findAll" parameterType="map" resultMap="productResultMap">
        select p.product_no, p.product_name, p.product_price, i.product_image_filename,
               case when f.product_no is not null then true else false end as favorite_enabled
        from PRODUCT p
                 left join PRODUCT_IMAGE i on p.product_no = i.product_no
                 left join FAVORITE f on p.product_no = f.product_no and f.member_no = #{memberNo}
        where p.product_category_no = #{categoryNo}
        order by p.product_no desc
        offset #{startRownum} rows fetch next #{endRownum} rows only
    </select>
-->
    <!-- 상품 상세 보기 -->

    <!-- 상품명으로 검색 -->
    <select id="findByProductName" parameterType="String" resultType="Product">
        select * from PRODUCT where product_name like '%'|| #{productName} || '%'
    </select>

    <!-- 필터(최신순) 검색 -->
    <!--
    <select id="findAllByLatestOrder" parameterType="map" resultMap="productResultMap">
        select * from PRODUCT
        where product_category_no = #{categoryNo}
        order by product_no desc
        offset #{startRownum} rows fetch next #{endRownum} rows only
    </select>
-->
    <!-- 필터(판매량) 검색 -->
    <!--
    <select id="findAllByOrderOfHighSales" parameterType="map" resultMap="productResultMap">
        select * from PRODUCT
        where product_category_no = #{categoryNo}
        order by product_stock asc
        offset #{startRownum} rows fetch next #{endRownum} rows only
    </select>
-->
    <!-- 필터(이름순) 검색 -->
    <!--
    <select id="findAllByProductName" parameterType="map" resultMap="productResultMap">
        select * from PRODUCT
        where product_category_no = #{categoryNo}
        order by product_name asc
        offset #{startRownum} rows fetch next #{endRownum} rows only
    </select>
    -->
</mapper>