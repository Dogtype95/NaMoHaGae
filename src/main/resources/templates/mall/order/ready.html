<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!------------------------------------------------------------------------------------------------------------------------------>
    <!--스크립트 태그-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>                    <!--jQuery-->
    <script src="https://kit.fontawesome.com/a606a1a405.js" crossorigin="anonymous"></script>                   <!--FontAwesome-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>        <!--BootStrap-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.all.min.js"></script>         <!--SweetAlert2-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>               <!--Toastr-->
    <!--CSS 링크-->
    <link rel="stylesheet" href="/css/main.css">                                                                <!--MainCSS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">    <!--FontAwesome-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">      <!--BootStrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.min.css">     <!--SweetAlert2-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">       <!--Toastr-->
    <!--기타 삽입-->

    <!------------------------------------------------------------------------------------------------------------------------------>
<title>상품 주문상세 페이지</title>
<script>
    $(document).ready(function() {
        $("#order").click(function() {
            const $form = $('<form>').attr('action', "/order/check").attr('method','post');
            $.each($(".addressNo"), function(idx, element) {
                if($(element).attr("checked")=="checked")
                    $('<input type="hidden" name="addressNo">').val($(element).val()).appendTo($form);
            });
            $form.appendTo($('body')).submit();
        })
    })
</script>
</head>
<body>
<header th:replace="~{/fragment/header.html}"></header>
<nav th:replace="~{/fragment/nav.html}"></nav>
<main>
    <aside th:replace="~{/fragment/aside.html}"></aside>
    <section>
        <div class="container mt-3">
            <h2>주문 상품</h2>
            <div th:each="i:${map.orderItems}" class="card">
                <div class="card-body">
                    <div class="product_info" style="overflow:hidden;">
                        <div style="float:left;">
                            <img th:src="${i.productImage}" width="100px" >
                        </div>
                        <div style="float:left; margin-left:20px;">
                            <p th:text="${i.productName}"></p>
                            <p>
                                <span th:text="${i.cartDetailPrice}"></span>원 /
                                <span th:text="${i.cartDetailCount}"></span>개
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <h2>배송지</h2>
        <div th:each="a:${map.addresses}" class="container mt-3">
            <div th:class="${a.defaultAddressEnabled==true} ? 'card bg-secondary text-white' : 'card'">
                <div class="card-body">
                    <input type="radio" class="form-check-input addressNo" th:checked="${a.defaultAddressEnabled}" th:value="${a.addressNo}" name="address">
                    (<span th:text="${a.addressName}"></span>)
                    <span th:text="${a.addressAddress}"></span>
                    <span th:text="${a.addressAddressDetail}"></span>
                </div>
            </div>
        </div>
        <div class="mb-3 mt-3">
            <a type="button" class="btn btn-primary" href="/member/mall/address/add">배송지 추가</a>
        </div>
        <hr>
        <div class="mb-3 mt-3 d-grid">
            <button id="order" type="button" class="btn btn-primary btn-block">결제하기</button>
        </div>
    </section>
    <aside th:replace="~{/fragment/bside.html}"></aside>
</main>
<footer th:replace="~{/fragment/footer.html}">
</footer>
</body>
</html>