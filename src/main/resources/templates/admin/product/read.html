<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/main.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<title>상품 상세 보기 페이지</title>
<style>
    #content {
        border: 1px solid #ccc;
    }
    #left {
        float:left;
        width: 50%;
        height:650px;
    }
    #right {
        float: right;
        width: 50%;
        display: flex;
        flex-direction: column;
        height:200px;
    }
    #buttons {
        display: inline-block;
    }

    .choice_image {
        border: 1px solid red;
    }

    .images:hover {
        cursor: pointer;
    }
</style>
<script>
    $(document).ready(function (){
        $('#put').click(function (){
            const formData = $('#form').serialize();
            $.ajax({
                url:'/api/v1/admin/product/put',
                type:'post',
                data: formData,
                success: function(data){
                    $('#productName').attr("value",data.productName);
                    $('#productStock').attr("value",data.productStock);
                    $('#productPrice').attr("value",data.productPrice);
                    $('#productContent').attr("value",data.productContent);
                    alert("성공적으로 변경하였습니다.");
                },
                error(err){
                    console.log(err);
                }
            })
        })
        $('#delete').click(function(){
            const deleteMessage = confirm("삭제하시겠습니까?");
            if (deleteMessage){
                $('#form').attr("action","/admin/product/delete").submit();
            }
        })
    })

</script>
</head>
<body>
<header th:replace="~{/fragment/header.html}">
</header>
<nav th:replace="~{/fragment/nav.html}">
</nav>
<main>
    <aside th:replace="~{/fragment/aside.html}">
    </aside>
    <section>
        <form id="form" method="post" enctype="multipart/form-data">
        <input type="hidden" name="productNo" th:value="${product.productNo}" id="productNo">
        <div style="overflow:hidden;">
            <div id="left">
                <div>
                    <img th:src="${product.productImages[0]}" id="select_image" height="200px">
                </div>
                <div>
                    <img th:each="image:${product.productImages}" th:src="${image}" width="100px" style="margin: 5px;" class='images'>
                </div>
            </div>
            <div id="right">
                <span class="product-price">
                    <input id="productName" name="productName" th:value="${product.productName}"><br>
                    <input id="productStock" name="productStock" th:value="${product.productStock}"><span> 개</span><br>
                    <input id="productPrice" name="productPrice" th:value="${product.productPrice}"><span> 원</span>
                </span>
            </div>
            <div id="buttons">
                <button id="put" type="button">상품 수정</button>
                <button id="delete" type="button">상품 삭제</button>
            </div>
        </div>
        <div id="content">
            <input id="productContent" name="productContent" th:value="${product.productContent}">
        </div>
        <hr>
        </form>
    </section>
</main>
<footer th:replace="~{/fragment/footer.html}">
</footer>
</body>
</html>