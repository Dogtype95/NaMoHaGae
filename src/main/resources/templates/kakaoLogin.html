<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!------------------------------------------------------------------------------------------------------------------------------>
    <!--스크립트 태그-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>                    <!--jQuery-->
    <script src="https://kit.fontawesome.com/a606a1a405.js" crossorigin="anonymous"></script>                   <!--FontAwesome-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>        <!--BootStrap-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.all.min.js"></script>         <!--SweetAlert2-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>               <!--Toastr-->
    <!--CSS 링크-->
    <link rel="stylesheet" href="/css/main.css">                                                                <!--MainCSS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">    <!--FontAwesome-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">      <!--BootStrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.min.css">     <!--SweetAlert2-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">       <!--Toastr-->
    <!--기타 삽입-->

    <!------------------------------------------------------------------------------------------------------------------------------>
    <title>나 뭐하개?</title>
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>


    <script>
       $(document).ready(function (){
           Kakao.init('06433b9c88fbeb5b8da71ebd01fd13ed');


           document.getElementById('login-btn').addEventListener('click', function() {
               Kakao.Auth.login({
                   success: function(authObj) {
                       console.log(authObj);
                   },
                   fail: function(error) {
                       console.log(error);
                   },
                   redirectUri: 'http://localhost:8081'
               });
           });

           $('#delete').click(function (){
               Kakao.Auth.login({
                   success: function(authObj) {
                       // 로그인 성공 시 액세스 토큰 값을 가져옴
                       const accessToken = authObj.access_token;

                       // 로그아웃 요청을 보냄
                       const xhr = new XMLHttpRequest();
                       xhr.open('POST', 'https://kapi.kakao.com/v1/user/logout');
                       xhr.setRequestHeader('Authorization', `Bearer ${accessToken}`);
                       xhr.onreadystatechange = function() {
                           if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                               // 로그아웃 성공 시 로직 처리
                               console.log('로그아웃 완료');
                           }
                       };
                       xhr.send();
                   },
                   fail: function(error) {
                       console.log(error);
                   },
               });
           });
       })
    </script>
</head>

<body>
<header th:replace="~{/fragment/header.html}"> </header>
<nav th:replace="~{/fragment/nav.html}"></nav>
<main>
    <aside th:replace="~{/fragment/aside.html}"></aside>
    <section>
        <h1>메인 페이지</h1>
        <article></article>
        <button id="login-btn">Kakao Login</button>
        <button id="delete">삭제</button>
    </section>
</main>
<footer th:replace="~{/fragment/footer.html}"></footer>
</body>
</html>
