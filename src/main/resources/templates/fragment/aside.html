<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
	<title>Insert title here</title>
	<style>
		div, ul, li {-webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;padding:0;margin:0}
		a {text-decoration:none;}

		.quickmenu {position:absolute;width:90px;top:50%;margin-top:-50px;right:10px;background:#fff;}
		.quickmenu ul {position:relative;float:left;width:100%;display:inline-block;*display:inline;border:1px solid #ddd;}
		.quickmenu ul li {float:left;width:100%;border-bottom:1px solid #ddd;text-align:center;display:inline-block;*display:inline;}
		.quickmenu ul li a {position:relative;float:left;width:100%;height:30px;line-height:30px;text-align:center;color:#999;font-size:9.5pt;}
		.quickmenu ul li a:hover {color:#000;}
		.quickmenu ul li:last-child {border-bottom:0;}

		.content {position:relative;min-height:1000px;}
	</style>
	<script>
		const mall = "mall";
		const puching = "puching";
		const member = "member";
		const board = "board";
		const admin	= "admin";
		function printBoard(quikmenu) {
			const $menu = $('#notificationquikmenu');
			console.log(quikmenu);
			quikmenu.forEach(n => {
				const tpl = `
             <a href="${n.notificationLink}" id="read">${n.notificationContent}</a>
        `;
				$menu.append(tpl);
			});
		}
		function printAside(){
			let sideBar = location.href.slice(22);
			console.log(sideBar);

			const $title = $('#title');
			const $side_bar = $('#side_bar');
			$title.text("");
			$side_bar.empty();
			if(sideBar.startsWith(mall)){
				$title.append('<li><a href="/mall/main">뼈다귀몰</a></li>');
				$side_bar.append('<li><a href="/mall/product/list?categoryNo=1">사료/간식</a></li>');
				$side_bar.append('<li><a href="/mall/product/list?categoryNo=2">장난감</a></li>');
				$side_bar.append('<li><a href="/mall/product/list?categoryNo=3">산책용품</a></li>');
				$side_bar.append('<li><a href="/mall/product/list?categoryNo=4">기타</a></li>');
			}else if(sideBar.startsWith(member)){
				$title.append('<li><a href="/member/main">내 정보 메인</a></li>');
				$side_bar.append('<li><h2>내 정보</h2></li>');
				$side_bar.append('<li><a href="/member/information">내 정보 수정</a></li>');
				$side_bar.append('<li><h2>퍼칭</h2></li>');
				$side_bar.append('<li><a href="/member/review">내게 쓴 리뷰</a></li>');
				$side_bar.append('<li><a href="/member/follow">팔로우 목록</a></li>');
				$side_bar.append('<li><h2>쇼핑몰</h2></li>');
				$side_bar.append('<li><a href="/member/mall/order">결제 내역</a></li>');
				$side_bar.append('<li><a href="/member/mall/address">배송지</a></li>');
				$side_bar.append('<li><a href="/member/mall/favorite">찜 목록</a></li>');
				$side_bar.append('<li><h2>게시판</h2></li>');
				$side_bar.append('<li><a href="/member/board/post">내가 작성한 게시물</a></li>');
				$side_bar.append('<li><a href="/member/board/comment">내가 작성한 댓글</a></li>');
				$side_bar.append('<li><a href="/member/board/question">내가 작성한 질문</a></li>');
				$side_bar.append('<li><a href="/member/board/answer">내가 작성한 답변</a></li>');
			}else if(sideBar.startsWith(puching)){
				$title.append('<li><a href="/puching/main">퍼칭 메인</a></li>');
				$side_bar.append('<li><a href="/puching/chatroom">채팅방</a></li>');
			}else if(sideBar.startsWith(board)){
				$title.append('<li><a href="/board/main">게시판 메인</a></li>');
				$side_bar.append('<li><a href="/board/notice/list">공지사항</a></li>');
				$side_bar.append('<li><a href="/board/free/list">자유 게시판</a></li>');
				$side_bar.append('<li><a href="/board/town/list">동네 게시판</a></li>');
				$side_bar.append('<li><a href="/board/knowledge/list">지식인</a></li>');
			}else if(sideBar.startsWith(admin)){
				$title.append('<li><a href="/admin/main">관리자 메인</a></li>');
				$side_bar.append('<li><a href="/admin/notice/list">공지사항</a></li>');
				$side_bar.append('<li><a href="/admin/qna/list">QnA</a></li>');
				$side_bar.append('<li><a href="/admin/product/list">상품 목록</a></li>');
				$side_bar.append('<li><a href="/admin/report/list">신고 관리</a></li>');
			}
		}
	</script>

	<script>
		$(document).ready(async function(){
			printAside();
			var currentPosition = parseInt($(".quickmenu").css("top"));
			$(window).scroll(function() {
				var position = $(window).scrollTop();
				$(".quickmenu").stop().animate({"top":position+currentPosition+"px"},1000);
			});
			try {
				const result = await $.ajax("/rest/notification/quikmenu");
				printBoard(result);
			}catch (err){
				console.log(err)
			}
			$(document).on("click", "#read", async function () {
				const no = $(this).data("no");
				try {
					await $.ajax({
						url: "/rest/notification/read/" + no,
						type: "PUT"
					});
					// 읽음 여부를 업데이트한 후의 작업을 수행
				} catch (err) {
					console.log(err);
				}
			})

		})


	</script>
</head>
<body>
<aside>
	<ul>
		<h1 id="title">
		</h1>
	</ul>
	<ul id="side_bar" class="side_bar">
	</ul>
	<div class="border4"></div>
	<div class="quickmenu">
		<ul id="notificationquikmenu">
		</ul>
	</div>
</aside>
</body>
</html>